---
layout: post
title: LinuxのLiveUSB作成方法
category : learning
tagline: "Ubuntu"
tags : [Ubuntu, Linux, OS, USB BOOT, LiveUSB]
---

Linux関連で必要なメモを以下に書き残しておく

[Linuxの導入手引き](http://kumasan1949.zouri.jp/kumasan.html)

## LiveUSBについて

使用するのはこんな感じのUSB

![usb16g](/images/2015-6-13-liveusb/usb16g.jpg)


## 日本語化について

USBブート後

日本語化設定ファイル編集

syslinux.cfgというファイルに以下を追加する.

    debian-installer/language=ja keyboard-configuration/layoutcode=jp keyboard-configuration/modelcode=jp106

### 4GB制限回避方法(パーティション分割)

UNetbootinというものを利用してインストールを行うのだが....

FAT32という形式でUSBをフォーマットせねばならず

そうすると、4GBまでしかUSBメモリを使用することができないという問題が出てしまう

そこで、パーティション分割し、FAT32とLinux用フォーマットのext4を組み合わせることで

4GB以上のデータのインストールに対応させるというものです。

まずLiveCDかLiveUSBが手元に存在して、Linux(Ubuntu)をフルインストールする手順を紹介します。

最初に、LiveCDかLiveUSBでOSを起動して、そこから新たに容量制限がないフルインストール版LiveUSBを作成する手順を紹介します。

#### (1)USBメモリのパーティションを分割

USBメモリをパソコンのUSBスロットに挿した状態で、「GParted」を起動させます。

![001](/images/2015-6-13-liveusb/001.png)

Unityパネルで「ｇｐ」と入力すれば、見つかると思います。

![002](/images/2015-6-13-liveusb/002.png)

GPartedが起動したら、右上端の「/dev/sda  (xxxGiB)」と表示されている部分をクリックしてみると、本体のディスク以外に、「/dev/sdb (USBメモリの容量）」が現れるので、選択します。

\#sdbの部分はマウントされているディスクによって表記が変わります

通常、USBメモリは、FAT32形式でフォーマット済みとなっていることでしょう。

![003](/images/2015-6-13-liveusb/003.png)

緑の枠内で右クリックして「アンマウント」を選んで、編集可能な状態にします。

![004](/images/2015-6-13-liveusb/004.png)

もう一度、右クリックから「削除」を選択

![005](/images/2015-6-13-liveusb/005.png)

上部アイコンメニューの一番右の緑のチェックアイコンをクリックして、適用させます

新たにパーティションを作成します

右クリックから「新規」を選択

![006](/images/2015-6-13-liveusb/006.png)

まずは、WindowsやMacなどでも読み書きができる領域を作成してみます。

「新規パーティションの作成」画面が別ウィンドウで出るので、「fat32形式」で好きな容量で、左詰めで、すなわち先頭部分に領域を確保します。

実はWindowsでは、ext2,3,4などのLinux形式のファイルシステムの領域を、またいで参照することができません。WindowsやMac上でこのUSBメモリを挿した時に、データを読み書きできるようにするには、このように先頭部分に「fat32形式」で領域を確保しておく必要があります。

私の場合、DVD-Rにデータを焼いてバックアップ、ということを考慮して、いつも4GB強を割りあてています。

![007](/images/2015-6-13-liveusb/007.png)

「追加」ボタンをクリックして、続けて残りの部分にUbuntu用に「ext4」形式などで領域を確保します。

![008](/images/2015-6-13-liveusb/008.png)

データの書き込み回数に制限があるUSBメモリということを考慮して、スワップ領域は、私の場合にはいつも作成しません。

![009](/images/2015-6-13-liveusb/009.png)

「適用」ボタンをクリックして、全ての操作を適用させます。

![010](/images/2015-6-13-liveusb/010.png)

完了するまでしばらく待ちます。

#### (2)USBメモリへの実インストール

![011](/images/2015-6-13-liveusb/011.png)

いよいよUSBメモリーへのUbuntuのインストール手順です。

通常のインストールと同じ手順で進めていきますが、下記の画面のところがUSBメモリーへのインストールのキモとなるところです。

![012](/images/2015-6-13-liveusb/012.png)

「インストールの種類」画面では、「それ以外」を選択します。

![013](/images/2015-6-13-liveusb/013.png)

先ほどUbuntu用に確保した「ext4」の領域を選択して「変更…」をクリック。ここで、USBメモリに割り当てられた記号（この例の場合、「/dev/sdｂ」）を覚えておきます。

他のハードディスクなどと間違わないように慎重に選択します。ここで誤ってすでに利用中のハードディスクを選んでしまうと、中身のデータが全て消えますのでご注意を！

![014](/images/2015-6-13-liveusb/014.png)

「パーティションを編集」という画面が出たら、

「利用方法」のリストから改めて「ext4」を選択。「パーティションの初期化」にはいちおうチェックしておきましょうか。

「マウントポイント」は「/」（ルート）を選びます。

#### (3)ブートローダーの設定

ここでとても重要なのが、ブートローダーの設定です。これを間違えるとUSBメモリーから起動できません。

![015](/images/2015-6-13-liveusb/015.png)

「ブートローダをインストールするデバイス：」で、USBメモリーを選びます。

この例の場合「/dev/sdb」となります。

あとは、通常のインストールと同じです。

#### (4)USBメモリからの起動

多くのネットブックやノートパソコンの場合、起動ドライブを一時的に選択する機能が「F12」などに割り当てられています。

電源投入後、所定のキーを押しておくことで、起動ドライブを選択する画面が現れますので、USBデバイスを一覧から選択して起動させます。

![016](/images/2015-6-13-liveusb/016.jpg)

続いて「ブートセレクタ」画面が現れるので、一番上が選ばれている状態でそのまま放置するか、「Enter」を押せばすぐに起動が始まります。

#### (5)グラフィックス・ドライバは追加しないほうが良い

機種によっては、高度なグラフィックス・ドライバの追加を促されますが、導入してしまうことで、高度なグラフィックスを搭載していない他機種でログインで失敗してしまうことがあるので、他機種でも利用USBメモリで起動させたいのであれば、追加しない方が無難です。

特に、プロプライエタリのドライバ（高度なグラフィックスドライバ）を追加で導入しなくても、実用上は問題ないと思います。

以上のように、ポイントさえ押さえれば、USBへのUbuntuのインストールは難しくありません。

これで、USBメモリーだけ持っていれば、ネットカフェなど、どのマシンでも、自分のいつもの環境を利用できます。作成したデータは先頭パーティションのFAT32の領域に保存しておけば、Windowsでも参照してデータを利用可能となります。

小さなUSBメモリーだけで、パソコンを動かしてしまうという楽しさを、ぜひお楽しみください！

※ ext4はそのままではWindowsで読み書きできません。(ext2fsdというWindowsソフトを使えば[自己責任ですが]読み書き可能になります。)

## USBメモリにOSインスコ後、アプリケーションがインストールできない不具合

libcupsimage2:amd64.listの破損が原因だった模様

[不具合の回復1](http://blogs.yahoo.co.jp/wyamamo/27147321.html)

[具体的な解決ファイル](https://packages.debian.org/sid/amd64/libcupsimage2/filelist)

### シェルの設定

[linuxの環境設定1](http://developer.mitakalab.com/ubuntu)

[linuxの環境設定2](http://snowsunny.hatenablog.com/entry/2014/04/03/211105)
